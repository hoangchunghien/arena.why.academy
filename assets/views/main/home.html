<div class="container arena-container">
    <div>


        <div class="box home chat chat-full noOverflow">


            <nav class="navbar navbar-default" role="navigation" ng-controller="NavCtrl" ng-init="init()">
    <div class="container-fluid">

        <div class="nav-no-collapse header-nav">
            <ul class="nav navbar-nav pull-left">

                <!-- start: User Dropdown -->
                <li class="dropdown">
                    <a class="btn account dropdown-toggle" data-toggle="dropdown" href="#">
                        <div class="avatar"><img ng-src="{{profile.picture_url}}" alt="Avatar"></div>
                       <!--  <div class="user">
                            <span class="hello">&nbsp;</span>
                            <span class="name" ng-bind="profile.name"></span>
                        </div> -->
                    </a>

                    <!--                         <ul class="dropdown-menu">
                                                <li class="dropdown-menu-title">

                                                </li>
                                                <li><a href="widgets.html#"><i class="fa fa-user"></i> Profile</a></li>
                                                <li><a href="widgets.html#"><i class="fa fa-cog"></i> Settings</a></li>
                                                <li><a href="widgets.html#"><i class="fa fa-envelope"></i> Messages</a></li>
                                                <li><a href="login.html"><i class="fa fa-off"></i> Logout</a></li>
                                            </ul> -->
                </li>
                <!-- end: User Dropdown -->
                <li class="nav-item">English Arena</li>
                <li class="dropdown">
                    <span class="h2"></span>
                    <img src="/images/loaders/spinner5.gif" ng-show="loading"/>
                </li>
            </ul>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1"> -->
        <ul class="nav navbar-nav navbar-right">
        <!--<li ng-show="!isAuth"><a href="" ng-click="doLogin()"><span class="h2"></span>Login</a></li>-->
        <!-- <li ng-show="isAuth" class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                <span class="h2"></span>
                <img ng-src="{{profile.picture_url}}" width="20" height="20">
                &nbsp<span ng-bind="profile.name"></span>
            </a> -->
        <!--&nbsp<b class="caret"></b></a>-->
        <!--<ul class="dropdown-menu">-->
        <!--<li>&nbsp;</li>-->
        <!--<li class="divider"></li>-->
        <li class="nav-item"><a href="" ng-click="doHelp()"><i class="fa fa-question-circle"></i> <span>Hướng dẫn</span></a></li>
        </ul>
        <!--                 </li>
                    </ul> -->

         <!-- </div> -->
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container-fluid -->
</nav>


<!--             <div class="box-title" >



                <div class="col-md-8" align="left">
                    <div class="avatar"><img ng-src="{{profile.picture_url}}" alt="Avatar"></div>
                    <span class="title">English Arena</span>
                </div>
                <div class="col-md-4" align="right">
                    <span ng-click="doHelp()" class="home-help">
                        <i class="fa fa-question-circle"></i> <span>Hướng dẫn</span>
                    </span>
                </div>
            </div> -->

            <div class="home-main" >
                <div class="actions" align="center">
                    <button class="btn btn-lg btn-success btn-action" ng-click="challengeWithRandom()">Trận Mới</button>
                </div>
                <div class="section-header">
                        <h2><i class="fa fa-flash"></i>Các Trận đấu đang diễn ra</h2>
                        
                    </div>

                    <div class="activities">
                        <table>
                            <tbody>
                            <tr ng-repeat="activity in activities">
                                <td>
                                    <div class="row"><img class="avatar" ng-src="{{activity.user.picture_url}}" alt="avatar"></div>
                                    <div class="row"><span class="name" ng-bind="activity.user.name"></span></div>

                                </td>
                                <td class="score">
                                    <span class="blue"><b>V.S</b></span>
                                </td>
                                <td>
                                    <div class="row"><img class="avatar" ng-src="{{activity.receiver.picture_url}}" alt="avatar"></div>
                                    <div class="row"><span class="name" ng-bind="activity.receiver.name"></span></div>
                                </td>
                                <td>
                                    <button type="button" class="btn"
                                            ng-bind="activityActionString(activity)"
                                            ng-class="{'btn-success' :activity.is_finished, 'btn-danger':activity.is_finished==null}"
                                            ng-click="activityAction(activity)"
                                            ng-hide="activity.status == 'waiting'">
                                    </button>
                                    <span ng-show="activity.status == 'waiting'" ng-bind="activityActionString(activity)">
                                    </span>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>

                <div class="status">
                    <span class="trophy label label-info"><i class="fa fa-trophy"></i></span><span class="highscore h4">Điểm cao nhất của bạn trong tuần</span>
                </div>
            </div>
            <div class="contacts">
                <div class="span4" ontablet="span6" ondesktop="span4">
                    <div class="section-header">
                        <h2><i class="fa fa-user"></i>Bạn bè</h2>

                    </div>
                    <div class="box-content">
                        <ul  class="dashboard-list">
                            <li ng-repeat="friend in friends">
                                <a >
                                    <img class="avatar" alt="{{friend.name}}" ng-src="{{friend.picture_url}}">
                                </a>
                                <b ng-bind="friend.name"></b>
                                <br>
                                <!-- Điểm cao: <span>1111</span><br> -->
                                <button class="btn btn-sm btn-success" ng-click="challengeFriend(friend)">Thách Đấu</button>
                            </li>
                            <li align="center">
                                <br /><br />
                                <a ng-click="playSoundClickedButton()" href="javascript:{}" class="btn btn-info bt-fs-dialog">Mời bạn bè vào Đấu trường</a>
                                <!-- <button class="btn btn-sm btn-success" ng-click="challengeFriend(friend)">Thách Đấu</button> -->
                            </li>

                        </ul>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <div align="center" class="comments">
        <div class="comments-title">Góp ý và bình luận</div>
        <div class="comments-content">
            <div class="fb-comments" data-href="https://apps.facebook.com/englisharena" data-numposts="5" data-colorscheme="light" href="https://apps.facebook.com/englisharena"></div>
        </div>

        <!-- <div class="fb-comments" data-href="https://localhost:1337/home" data-numposts="5" data-colorscheme="light" href="https://localhost:1337/home"></div> -->
        <br/><br/><br/><br/>
    </div>

</div>




<script type="text/javascript">

    jQuery(document).ready(function($) {

        var friendIds;
        $(".bt-fs-dialog").click(function(){
            if (!friendIds) {
                FB.api('/me/invitable_friends', function (response) {
                    if (response.data) {
                        friendIds = [];
                        var data = response.data;
                        for (var i in data) {
                            friendIds.push(data[i].id);
                        }
                        showDialog(); // reload the dialog when loaded friends
                    }
                });
            }
            else {
                showDialog(); // show the loading if the friends is not loading yet
            }

        });

        var showDialog = function() {
            FB.ui({
                method: 'apprequests',
                message: "Tham gia đấu trường English Arena",
                filters: [{name :'Friends to invite', user_ids: friendIds}]
            }, function(response){
                ApolloAnalytics.track('Invite Friends', {'friends': response});
            });
        };

//        $(".bt-fs-dialog").fSelector({
//            facebookInvite: true,
//            lang: {
//                facebookInviteMessage: "Tham gia đấu trường English Arena"
//            },
//            onSubmit: function(response){
//                // example response usage
//                // alert(response);
//                ApolloAnalytics.track('Envite Friends', {'friends': response});
//            }
//        });


        // rescan Facebook Comments box
        FB.XFBML.parse();
    });
</script>
